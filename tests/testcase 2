// Import shared setup file (e.g., for global imports or configurations)
require("../testSetup");

// Define the test suite called "Functional Test"
describe("Functional Test", async function () {

  // Runs before each test case
  beforeEach(async function () {
    console.log("Before each test"); // Log to indicate start of test
  });

  // Runs after each test case
  this.afterEach(async function () {
    console.log("End of Test"); // Log to indicate end of test
  });

  // Define an individual test case
  it("TC001 - Allow a valid user to login to BookStore", async function () {
    // Create a new Chrome WebDriver instance
    let driver = await new Builder().forBrowser(Browser.CHROME).build();

    // Read test data for "tc001" from the data.json file
    const tcData = await readData("tc001");

    try {
      console.log("TC001 start"); // Log test case start

      // Attempt to log in using credentials from the test data
      await login(driver, tcData.data.username, tcData.data.password);

      // Take a screenshot after login attempt
      var filename1 = await takeScreenshot(driver);

      // Add first screenshot to Mochawesome report context
      moreDetails(this, "../" + filename1);

      // Verify that login was successful by checking expected text on page
      await verifyLoginSuccess(driver, tcData.data.expectedText);

      // Take another screenshot after successful verification
      var filename2 = await takeScreenshot(driver);

      // Add second screenshot to Mochawesome report context
      moreDetails(this, "../" + filename2);

    } catch (error) {
      // Log any errors encountered during test
      console.log(error);
    } finally {
      // Close the browser, regardless of test result
      await driver.quit();

      // Log test case exit
      console.log("----------------");
      console.log("TC001 exit");
    }
  });

});
